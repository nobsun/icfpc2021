{-# LANGUAGE LambdaCase #-}
{-# LANGUAGE MultiWayIf #-}
{-# LANGUAGE BangPatterns #-}
{-# LANGUAGE ScopedTypeVariables #-}
module Bonus where

-- import Data.Aeson
import System.FilePath
import Text.Printf
import qualified Data.Graph.Inductive as G
import Parser as P
-- import Graph

{- |
>>> path = "data/problems"
>>> bonusdepg = getBonusDeps path 132
>>> G.labEdges <$> bonusdepg
[(1,35,BonusDef {position = Point {x = 62, y = 46}, bonus = GLOBALIST, problem = 35}),(1,38,BonusDef {position = Point {x = 23, y = 68}, bonus = BREAK_A_LEG, problem = 38}),(1,50,BonusDef {position = Point {x = 77, y = 68}, bonus = WALLHACK, problem = 50}),(2,39,BonusDef {position = Point {x = 75, y = 5}, bonus = BREAK_A_LEG, problem = 39}),(2,81,BonusDef {position = Point {x = 38, y = 59}, bonus = BREAK_A_LEG, problem = 81}),(2,87,BonusDef {position = Point {x = 65, y = 44}, bonus = GLOBALIST, problem = 87}),(3,59,BonusDef {position = Point {x = 90, y = 59}, bonus = WALLHACK, problem = 59}),(3,60,BonusDef {position = Point {x = 45, y = 110}, bonus = GLOBALIST, problem = 60}),(3,81,BonusDef {position = Point {x = 39, y = 38}, bonus = GLOBALIST, problem = 81}),(4,17,BonusDef {position = Point {x = 59, y = 59}, bonus = BREAK_A_LEG, problem = 17}),(4,63,BonusDef {position = Point {x = 95, y = 26}, bonus = BREAK_A_LEG, problem = 63}),(4,92,BonusDef {position = Point {x = 5, y = 32}, bonus = BREAK_A_LEG, problem = 92}),(5,10,BonusDef {position = Point {x = 80, y = 65}, bonus = WALLHACK, problem = 10}),(5,78,BonusDef {position = Point {x = 99, y = 71}, bonus = BREAK_A_LEG, problem = 78}),(5,110,BonusDef {position = Point {x = 65, y = 20}, bonus = BREAK_A_LEG, problem = 110}),(6,16,BonusDef {position = Point {x = 183, y = 61}, bonus = GLOBALIST, problem = 16}),(6,26,BonusDef {position = Point {x = 147, y = 78}, bonus = SUPERFLEX, problem = 26}),(6,50,BonusDef {position = Point {x = 111, y = 153}, bonus = SUPERFLEX, problem = 50}),(7,12,BonusDef {position = Point {x = 65, y = 1}, bonus = GLOBALIST, problem = 12}),(7,95,BonusDef {position = Point {x = 26, y = 73}, bonus = BREAK_A_LEG, problem = 95}),(7,115,BonusDef {position = Point {x = 53, y = 4}, bonus = WALLHACK, problem = 115}),(8,6,BonusDef {position = Point {x = 90, y = 19}, bonus = BREAK_A_LEG, problem = 6}),(8,79,BonusDef {position = Point {x = 55, y = 45}, bonus = WALLHACK, problem = 79}),(8,105,BonusDef {position = Point {x = 76, y = 24}, bonus = BREAK_A_LEG, problem = 105}),(9,14,BonusDef {position = Point {x = 119, y = 5}, bonus = BREAK_A_LEG, problem = 14}),(9,60,BonusDef {position = Point {x = 5, y = 32}, bonus = SUPERFLEX, problem = 60}),(9,64,BonusDef {position = Point {x = 107, y = 134}, bonus = GLOBALIST, problem = 64}),(10,62,BonusDef {position = Point {x = 26, y = 86}, bonus = GLOBALIST, problem = 62}),(10,76,BonusDef {position = Point {x = 29, y = 8}, bonus = GLOBALIST, problem = 76}),(10,85,BonusDef {position = Point {x = 41, y = 86}, bonus = SUPERFLEX, problem = 85}),(11,20,BonusDef {position = Point {x = 9, y = 6}, bonus = GLOBALIST, problem = 20}),(11,31,BonusDef {position = Point {x = 5, y = 5}, bonus = BREAK_A_LEG, problem = 31}),(11,49,BonusDef {position = Point {x = 6, y = 9}, bonus = GLOBALIST, problem = 49}),(12,30,BonusDef {position = Point {x = 48, y = 3}, bonus = SUPERFLEX, problem = 30}),(12,67,BonusDef {position = Point {x = 42, y = 2}, bonus = BREAK_A_LEG, problem = 67}),(12,69,BonusDef {position = Point {x = 15, y = 3}, bonus = WALLHACK, problem = 69}),(13,20,BonusDef {position = Point {x = 30, y = 12}, bonus = GLOBALIST, problem = 20}),(13,46,BonusDef {position = Point {x = 20, y = 20}, bonus = GLOBALIST, problem = 46}),(13,88,BonusDef {position = Point {x = 30, y = 30}, bonus = BREAK_A_LEG, problem = 88}),(14,53,BonusDef {position = Point {x = 6, y = 0}, bonus = GLOBALIST, problem = 53}),(14,57,BonusDef {position = Point {x = 5, y = 5}, bonus = BREAK_A_LEG, problem = 57}),(14,118,BonusDef {position = Point {x = 3, y = 0}, bonus = GLOBALIST, problem = 118}),(15,41,BonusDef {position = Point {x = 16, y = 28}, bonus = GLOBALIST, problem = 41}),(15,78,BonusDef {position = Point {x = 12, y = 15}, bonus = SUPERFLEX, problem = 78}),(15,94,BonusDef {position = Point {x = 27, y = 30}, bonus = GLOBALIST, problem = 94}),(16,8,BonusDef {position = Point {x = 16, y = 19}, bonus = BREAK_A_LEG, problem = 8}),(16,32,BonusDef {position = Point {x = 12, y = 30}, bonus = GLOBALIST, problem = 32}),(16,74,BonusDef {position = Point {x = 27, y = 27}, bonus = BREAK_A_LEG, problem = 74}),(17,67,BonusDef {position = Point {x = 9, y = 48}, bonus = BREAK_A_LEG, problem = 67}),(17,68,BonusDef {position = Point {x = 39, y = 33}, bonus = SUPERFLEX, problem = 68}),(17,84,BonusDef {position = Point {x = 24, y = 24}, bonus = GLOBALIST, problem = 84}),(18,65,BonusDef {position = Point {x = 12, y = 45}, bonus = GLOBALIST, problem = 65}),(18,72,BonusDef {position = Point {x = 17, y = 10}, bonus = GLOBALIST, problem = 72}),(18,129,BonusDef {position = Point {x = 9, y = 18}, bonus = GLOBALIST, problem = 129}),(19,32,BonusDef {position = Point {x = 34, y = 32}, bonus = GLOBALIST, problem = 32}),(19,33,BonusDef {position = Point {x = 39, y = 48}, bonus = WALLHACK, problem = 33}),(19,71,BonusDef {position = Point {x = 21, y = 42}, bonus = SUPERFLEX, problem = 71}),(20,6,BonusDef {position = Point {x = 51, y = 30}, bonus = WALLHACK, problem = 6}),(20,49,BonusDef {position = Point {x = 20, y = 20}, bonus = GLOBALIST, problem = 49}),(20,97,BonusDef {position = Point {x = 39, y = 39}, bonus = GLOBALIST, problem = 97}),(21,17,BonusDef {position = Point {x = 4, y = 22}, bonus = GLOBALIST, problem = 17}),(21,73,BonusDef {position = Point {x = 24, y = 39}, bonus = BREAK_A_LEG, problem = 73}),(21,111,BonusDef {position = Point {x = 45, y = 30}, bonus = BREAK_A_LEG, problem = 111}),(22,64,BonusDef {position = Point {x = 75, y = 18}, bonus = WALLHACK, problem = 64}),(22,67,BonusDef {position = Point {x = 21, y = 18}, bonus = GLOBALIST, problem = 67}),(22,74,BonusDef {position = Point {x = 47, y = 18}, bonus = GLOBALIST, problem = 74}),(23,18,BonusDef {position = Point {x = 28, y = 46}, bonus = BREAK_A_LEG, problem = 18}),(23,37,BonusDef {position = Point {x = 42, y = 33}, bonus = SUPERFLEX, problem = 37}),(23,124,BonusDef {position = Point {x = 45, y = 54}, bonus = BREAK_A_LEG, problem = 124}),(24,73,BonusDef {position = Point {x = 46, y = 21}, bonus = BREAK_A_LEG, problem = 73}),(24,80,BonusDef {position = Point {x = 21, y = 45}, bonus = WALLHACK, problem = 80}),(24,128,BonusDef {position = Point {x = 54, y = 36}, bonus = GLOBALIST, problem = 128}),(25,16,BonusDef {position = Point {x = 21, y = 18}, bonus = WALLHACK, problem = 16}),(25,30,BonusDef {position = Point {x = 26, y = 68}, bonus = BREAK_A_LEG, problem = 30}),(25,82,BonusDef {position = Point {x = 6, y = 72}, bonus = GLOBALIST, problem = 82}),(26,19,BonusDef {position = Point {x = 53, y = 58}, bonus = BREAK_A_LEG, problem = 19}),(26,77,BonusDef {position = Point {x = 24, y = 42}, bonus = SUPERFLEX, problem = 77}),(26,78,BonusDef {position = Point {x = 66, y = 36}, bonus = WALLHACK, problem = 78}),(27,23,BonusDef {position = Point {x = 0, y = 40}, bonus = BREAK_A_LEG, problem = 23}),(27,47,BonusDef {position = Point {x = 15, y = 12}, bonus = SUPERFLEX, problem = 47}),(27,107,BonusDef {position = Point {x = 33, y = 12}, bonus = WALLHACK, problem = 107}),(28,36,BonusDef {position = Point {x = 9, y = 12}, bonus = GLOBALIST, problem = 36}),(28,65,BonusDef {position = Point {x = 28, y = 40}, bonus = GLOBALIST, problem = 65}),(28,80,BonusDef {position = Point {x = 3, y = 15}, bonus = SUPERFLEX, problem = 80}),(29,9,BonusDef {position = Point {x = 24, y = 12}, bonus = GLOBALIST, problem = 9}),(29,58,BonusDef {position = Point {x = 3, y = 0}, bonus = GLOBALIST, problem = 58}),(29,114,BonusDef {position = Point {x = 30, y = 15}, bonus = BREAK_A_LEG, problem = 114}),(30,10,BonusDef {position = Point {x = 0, y = 5}, bonus = BREAK_A_LEG, problem = 10}),(30,34,BonusDef {position = Point {x = 30, y = 18}, bonus = GLOBALIST, problem = 34}),(30,105,BonusDef {position = Point {x = 18, y = 27}, bonus = SUPERFLEX, problem = 105}),(31,8,BonusDef {position = Point {x = 36, y = 18}, bonus = WALLHACK, problem = 8}),(31,75,BonusDef {position = Point {x = 57, y = 66}, bonus = GLOBALIST, problem = 75}),(31,130,BonusDef {position = Point {x = 18, y = 18}, bonus = SUPERFLEX, problem = 130}),(32,5,BonusDef {position = Point {x = 30, y = 15}, bonus = BREAK_A_LEG, problem = 5}),(32,29,BonusDef {position = Point {x = 26, y = 1}, bonus = BREAK_A_LEG, problem = 29}),(32,72,BonusDef {position = Point {x = 15, y = 30}, bonus = BREAK_A_LEG, problem = 72}),(33,53,BonusDef {position = Point {x = 12, y = 53}, bonus = BREAK_A_LEG, problem = 53}),(33,71,BonusDef {position = Point {x = 21, y = 33}, bonus = BREAK_A_LEG, problem = 71}),(33,131,BonusDef {position = Point {x = 15, y = 21}, bonus = GLOBALIST, problem = 131}),(34,4,BonusDef {position = Point {x = 20, y = 52}, bonus = BREAK_A_LEG, problem = 4}),(34,12,BonusDef {position = Point {x = 54, y = 36}, bonus = GLOBALIST, problem = 12}),(34,13,BonusDef {position = Point {x = 69, y = 21}, bonus = GLOBALIST, problem = 13}),(35,14,BonusDef {position = Point {x = 39, y = 36}, bonus = WALLHACK, problem = 14}),(35,47,BonusDef {position = Point {x = 16, y = 19}, bonus = GLOBALIST, problem = 47}),(35,126,BonusDef {position = Point {x = 9, y = 45}, bonus = WALLHACK, problem = 126}),(36,75,BonusDef {position = Point {x = 15, y = 9}, bonus = GLOBALIST, problem = 75}),(36,82,BonusDef {position = Point {x = 36, y = 26}, bonus = BREAK_A_LEG, problem = 82}),(36,96,BonusDef {position = Point {x = 18, y = 15}, bonus = BREAK_A_LEG, problem = 96}),(37,1,BonusDef {position = Point {x = 39, y = 0}, bonus = SUPERFLEX, problem = 1}),(37,15,BonusDef {position = Point {x = 27, y = 27}, bonus = BREAK_A_LEG, problem = 15}),(37,119,BonusDef {position = Point {x = 15, y = 0}, bonus = BREAK_A_LEG, problem = 119}),(38,76,BonusDef {position = Point {x = 32, y = 48}, bonus = GLOBALIST, problem = 76}),(38,84,BonusDef {position = Point {x = 21, y = 36}, bonus = WALLHACK, problem = 84}),(38,101,BonusDef {position = Point {x = 51, y = 45}, bonus = SUPERFLEX, problem = 101}),(39,29,BonusDef {position = Point {x = 54, y = 54}, bonus = BREAK_A_LEG, problem = 29}),(39,37,BonusDef {position = Point {x = 27, y = 86}, bonus = GLOBALIST, problem = 37}),(39,100,BonusDef {position = Point {x = 27, y = 27}, bonus = BREAK_A_LEG, problem = 100}),(40,17,BonusDef {position = Point {x = 27, y = 48}, bonus = SUPERFLEX, problem = 17}),(40,45,BonusDef {position = Point {x = 40, y = 26}, bonus = GLOBALIST, problem = 45}),(40,109,BonusDef {position = Point {x = 24, y = 18}, bonus = WALLHACK, problem = 109}),(41,54,BonusDef {position = Point {x = 30, y = 35}, bonus = GLOBALIST, problem = 54}),(41,82,BonusDef {position = Point {x = 6, y = 15}, bonus = SUPERFLEX, problem = 82}),(41,92,BonusDef {position = Point {x = 12, y = 33}, bonus = WALLHACK, problem = 92}),(42,48,BonusDef {position = Point {x = 15, y = 18}, bonus = WALLHACK, problem = 48}),(42,79,BonusDef {position = Point {x = 56, y = 2}, bonus = BREAK_A_LEG, problem = 79}),(42,127,BonusDef {position = Point {x = 39, y = 36}, bonus = SUPERFLEX, problem = 127}),(43,40,BonusDef {position = Point {x = 30, y = 18}, bonus = WALLHACK, problem = 40}),(43,66,BonusDef {position = Point {x = 75, y = 14}, bonus = BREAK_A_LEG, problem = 66}),(43,88,BonusDef {position = Point {x = 54, y = 24}, bonus = BREAK_A_LEG, problem = 88}),(44,5,BonusDef {position = Point {x = 30, y = 27}, bonus = WALLHACK, problem = 5}),(44,73,BonusDef {position = Point {x = 21, y = 60}, bonus = WALLHACK, problem = 73}),(44,88,BonusDef {position = Point {x = 19, y = 1}, bonus = BREAK_A_LEG, problem = 88}),(45,25,BonusDef {position = Point {x = 60, y = 7}, bonus = GLOBALIST, problem = 25}),(45,48,BonusDef {position = Point {x = 34, y = 66}, bonus = SUPERFLEX, problem = 48}),(45,52,BonusDef {position = Point {x = 28, y = 54}, bonus = WALLHACK, problem = 52}),(46,16,BonusDef {position = Point {x = 15, y = 48}, bonus = GLOBALIST, problem = 16}),(46,28,BonusDef {position = Point {x = 43, y = 44}, bonus = BREAK_A_LEG, problem = 28}),(46,31,BonusDef {position = Point {x = 66, y = 21}, bonus = WALLHACK, problem = 31}),(47,27,BonusDef {position = Point {x = 21, y = 18}, bonus = SUPERFLEX, problem = 27}),(47,43,BonusDef {position = Point {x = 59, y = 26}, bonus = BREAK_A_LEG, problem = 43}),(47,58,BonusDef {position = Point {x = 54, y = 9}, bonus = SUPERFLEX, problem = 58}),(48,11,BonusDef {position = Point {x = 0, y = 67}, bonus = BREAK_A_LEG, problem = 11}),(48,13,BonusDef {position = Point {x = 48, y = 57}, bonus = SUPERFLEX, problem = 13}),(48,76,BonusDef {position = Point {x = 39, y = 18}, bonus = SUPERFLEX, problem = 76}),(49,36,BonusDef {position = Point {x = 24, y = 16}, bonus = BREAK_A_LEG, problem = 36}),(49,66,BonusDef {position = Point {x = 27, y = 36}, bonus = WALLHACK, problem = 66}),(49,104,BonusDef {position = Point {x = 9, y = 12}, bonus = BREAK_A_LEG, problem = 104}),(50,9,BonusDef {position = Point {x = 0, y = 8}, bonus = GLOBALIST, problem = 9}),(50,70,BonusDef {position = Point {x = 33, y = 48}, bonus = GLOBALIST, problem = 70}),(50,91,BonusDef {position = Point {x = 42, y = 33}, bonus = WALLHACK, problem = 91}),(51,21,BonusDef {position = Point {x = 42, y = 84}, bonus = SUPERFLEX, problem = 21}),(51,71,BonusDef {position = Point {x = 44, y = 46}, bonus = BREAK_A_LEG, problem = 71}),(51,72,BonusDef {position = Point {x = 27, y = 51}, bonus = GLOBALIST, problem = 72}),(52,29,BonusDef {position = Point {x = 18, y = 63}, bonus = WALLHACK, problem = 29}),(52,55,BonusDef {position = Point {x = 61, y = 21}, bonus = GLOBALIST, problem = 55}),(52,113,BonusDef {position = Point {x = 39, y = 36}, bonus = SUPERFLEX, problem = 113}),(53,38,BonusDef {position = Point {x = 65, y = 48}, bonus = GLOBALIST, problem = 38}),(53,44,BonusDef {position = Point {x = 42, y = 21}, bonus = BREAK_A_LEG, problem = 44}),(53,116,BonusDef {position = Point {x = 114, y = 99}, bonus = GLOBALIST, problem = 116}),(54,12,BonusDef {position = Point {x = 60, y = 66}, bonus = SUPERFLEX, problem = 12}),(54,24,BonusDef {position = Point {x = 47, y = 27}, bonus = GLOBALIST, problem = 24}),(54,65,BonusDef {position = Point {x = 33, y = 39}, bonus = BREAK_A_LEG, problem = 65}),(55,7,BonusDef {position = Point {x = 39, y = 58}, bonus = GLOBALIST, problem = 7}),(55,19,BonusDef {position = Point {x = 21, y = 48}, bonus = GLOBALIST, problem = 19}),(55,47,BonusDef {position = Point {x = 24, y = 78}, bonus = WALLHACK, problem = 47}),(56,11,BonusDef {position = Point {x = 24, y = 30}, bonus = SUPERFLEX, problem = 11}),(56,50,BonusDef {position = Point {x = 1, y = 95}, bonus = GLOBALIST, problem = 50}),(56,90,BonusDef {position = Point {x = 54, y = 66}, bonus = WALLHACK, problem = 90}),(57,4,BonusDef {position = Point {x = 18, y = 99}, bonus = GLOBALIST, problem = 4}),(57,14,BonusDef {position = Point {x = 78, y = 90}, bonus = SUPERFLEX, problem = 14}),(57,33,BonusDef {position = Point {x = 19, y = 122}, bonus = GLOBALIST, problem = 33}),(58,15,BonusDef {position = Point {x = 75, y = 18}, bonus = WALLHACK, problem = 15}),(58,68,BonusDef {position = Point {x = 104, y = 53}, bonus = GLOBALIST, problem = 68}),(58,106,BonusDef {position = Point {x = 42, y = 21}, bonus = BREAK_A_LEG, problem = 106}),(59,3,BonusDef {position = Point {x = 88, y = 64}, bonus = BREAK_A_LEG, problem = 3}),(59,55,BonusDef {position = Point {x = 87, y = 87}, bonus = SUPERFLEX, problem = 55}),(59,60,BonusDef {position = Point {x = 87, y = 42}, bonus = WALLHACK, problem = 60}),(60,41,BonusDef {position = Point {x = 66, y = 18}, bonus = GLOBALIST, problem = 41}),(60,79,BonusDef {position = Point {x = 75, y = 78}, bonus = GLOBALIST, problem = 79}),(60,80,BonusDef {position = Point {x = 78, y = 95}, bonus = GLOBALIST, problem = 80}),(61,20,BonusDef {position = Point {x = 9, y = 126}, bonus = BREAK_A_LEG, problem = 20}),(61,98,BonusDef {position = Point {x = 111, y = 10}, bonus = SUPERFLEX, problem = 98}),(61,132,BonusDef {position = Point {x = 21, y = 73}, bonus = GLOBALIST, problem = 132}),(62,22,BonusDef {position = Point {x = 33, y = 0}, bonus = WALLHACK, problem = 22}),(62,22,BonusDef {position = Point {x = 237, y = 151}, bonus = GLOBALIST, problem = 22}),(62,74,BonusDef {position = Point {x = 159, y = 126}, bonus = SUPERFLEX, problem = 74}),(63,18,BonusDef {position = Point {x = 96, y = 21}, bonus = GLOBALIST, problem = 18}),(63,21,BonusDef {position = Point {x = 106, y = 65}, bonus = BREAK_A_LEG, problem = 21}),(63,38,BonusDef {position = Point {x = 33, y = 24}, bonus = WALLHACK, problem = 38}),(64,4,BonusDef {position = Point {x = 99, y = 156}, bonus = WALLHACK, problem = 4}),(64,83,BonusDef {position = Point {x = 147, y = 24}, bonus = WALLHACK, problem = 83}),(64,85,BonusDef {position = Point {x = 150, y = 77}, bonus = GLOBALIST, problem = 85}),(65,42,BonusDef {position = Point {x = 143, y = 246}, bonus = BREAK_A_LEG, problem = 42}),(65,49,BonusDef {position = Point {x = 210, y = 279}, bonus = WALLHACK, problem = 49}),(65,62,BonusDef {position = Point {x = 117, y = 285}, bonus = GLOBALIST, problem = 62}),(66,31,BonusDef {position = Point {x = 90, y = 63}, bonus = GLOBALIST, problem = 31}),(66,34,BonusDef {position = Point {x = 105, y = 3}, bonus = GLOBALIST, problem = 34}),(66,103,BonusDef {position = Point {x = 75, y = 69}, bonus = SUPERFLEX, problem = 103}),(67,5,BonusDef {position = Point {x = 8, y = 45}, bonus = GLOBALIST, problem = 5}),(67,42,BonusDef {position = Point {x = 30, y = 24}, bonus = SUPERFLEX, problem = 42}),(67,45,BonusDef {position = Point {x = 24, y = 18}, bonus = GLOBALIST, problem = 45}),(68,69,BonusDef {position = Point {x = 33, y = 85}, bonus = BREAK_A_LEG, problem = 69}),(68,99,BonusDef {position = Point {x = 282, y = 162}, bonus = SUPERFLEX, problem = 99}),(68,102,BonusDef {position = Point {x = 282, y = 66}, bonus = WALLHACK, problem = 102}),(69,3,BonusDef {position = Point {x = 36, y = 118}, bonus = WALLHACK, problem = 3}),(69,28,BonusDef {position = Point {x = 48, y = 22}, bonus = WALLHACK, problem = 28}),(69,70,BonusDef {position = Point {x = 106, y = 85}, bonus = GLOBALIST, problem = 70}),(70,54,BonusDef {position = Point {x = 42, y = 30}, bonus = WALLHACK, problem = 54}),(70,61,BonusDef {position = Point {x = 54, y = 31}, bonus = BREAK_A_LEG, problem = 61}),(70,103,BonusDef {position = Point {x = 21, y = 36}, bonus = WALLHACK, problem = 103}),(71,87,BonusDef {position = Point {x = 285, y = 150}, bonus = BREAK_A_LEG, problem = 87}),(71,89,BonusDef {position = Point {x = 234, y = 51}, bonus = GLOBALIST, problem = 89}),(71,120,BonusDef {position = Point {x = 285, y = 111}, bonus = WALLHACK, problem = 120}),(72,32,BonusDef {position = Point {x = 28, y = 107}, bonus = SUPERFLEX, problem = 32}),(72,40,BonusDef {position = Point {x = 164, y = 153}, bonus = GLOBALIST, problem = 40}),(72,117,BonusDef {position = Point {x = 91, y = 152}, bonus = SUPERFLEX, problem = 117}),(73,11,BonusDef {position = Point {x = 6, y = 48}, bonus = BREAK_A_LEG, problem = 11}),(73,41,BonusDef {position = Point {x = 30, y = 36}, bonus = GLOBALIST, problem = 41}),(73,86,BonusDef {position = Point {x = 20, y = 58}, bonus = BREAK_A_LEG, problem = 86}),(74,56,BonusDef {position = Point {x = 216, y = 78}, bonus = SUPERFLEX, problem = 56}),(74,77,BonusDef {position = Point {x = 204, y = 285}, bonus = BREAK_A_LEG, problem = 77}),(74,121,BonusDef {position = Point {x = 150, y = 240}, bonus = WALLHACK, problem = 121}),(75,35,BonusDef {position = Point {x = 99, y = 138}, bonus = SUPERFLEX, problem = 35}),(75,51,BonusDef {position = Point {x = 63, y = 51}, bonus = BREAK_A_LEG, problem = 51}),(75,81,BonusDef {position = Point {x = 57, y = 160}, bonus = BREAK_A_LEG, problem = 81}),(76,15,BonusDef {position = Point {x = 126, y = 21}, bonus = SUPERFLEX, problem = 15}),(76,46,BonusDef {position = Point {x = 225, y = 108}, bonus = SUPERFLEX, problem = 46}),(76,64,BonusDef {position = Point {x = 16, y = 98}, bonus = BREAK_A_LEG, problem = 64}),(77,8,BonusDef {position = Point {x = 57, y = 45}, bonus = SUPERFLEX, problem = 8}),(77,39,BonusDef {position = Point {x = 81, y = 45}, bonus = GLOBALIST, problem = 39}),(77,83,BonusDef {position = Point {x = 77, y = 30}, bonus = GLOBALIST, problem = 83}),(78,24,BonusDef {position = Point {x = 71, y = 157}, bonus = SUPERFLEX, problem = 24}),(78,35,BonusDef {position = Point {x = 143, y = 151}, bonus = BREAK_A_LEG, problem = 35}),(78,56,BonusDef {position = Point {x = 15, y = 100}, bonus = BREAK_A_LEG, problem = 56}),(79,1,BonusDef {position = Point {x = 0, y = 209}, bonus = GLOBALIST, problem = 1}),(79,62,BonusDef {position = Point {x = 57, y = 15}, bonus = BREAK_A_LEG, problem = 62}),(79,83,BonusDef {position = Point {x = 39, y = 48}, bonus = WALLHACK, problem = 83}),(80,13,BonusDef {position = Point {x = 195, y = 171}, bonus = GLOBALIST, problem = 13}),(80,93,BonusDef {position = Point {x = 156, y = 174}, bonus = WALLHACK, problem = 93}),(80,112,BonusDef {position = Point {x = 249, y = 204}, bonus = SUPERFLEX, problem = 112}),(81,27,BonusDef {position = Point {x = 27, y = 43}, bonus = BREAK_A_LEG, problem = 27}),(81,43,BonusDef {position = Point {x = 111, y = 36}, bonus = WALLHACK, problem = 43}),(81,69,BonusDef {position = Point {x = 57, y = 12}, bonus = SUPERFLEX, problem = 69}),(82,2,BonusDef {position = Point {x = 194, y = 218}, bonus = GLOBALIST, problem = 2}),(82,75,BonusDef {position = Point {x = 165, y = 114}, bonus = SUPERFLEX, problem = 75}),(82,108,BonusDef {position = Point {x = 162, y = 189}, bonus = BREAK_A_LEG, problem = 108}),(83,44,BonusDef {position = Point {x = 75, y = 2}, bonus = GLOBALIST, problem = 44}),(83,63,BonusDef {position = Point {x = 45, y = 33}, bonus = SUPERFLEX, problem = 63}),(83,101,BonusDef {position = Point {x = 168, y = 177}, bonus = SUPERFLEX, problem = 101}),(84,46,BonusDef {position = Point {x = 21, y = 96}, bonus = BREAK_A_LEG, problem = 46}),(84,52,BonusDef {position = Point {x = 40, y = 98}, bonus = GLOBALIST, problem = 52}),(84,99,BonusDef {position = Point {x = 33, y = 60}, bonus = SUPERFLEX, problem = 99}),(85,48,BonusDef {position = Point {x = 60, y = 62}, bonus = BREAK_A_LEG, problem = 48}),(85,57,BonusDef {position = Point {x = 108, y = 60}, bonus = SUPERFLEX, problem = 57}),(85,87,BonusDef {position = Point {x = 75, y = 15}, bonus = GLOBALIST, problem = 87}),(86,51,BonusDef {position = Point {x = 69, y = 97}, bonus = BREAK_A_LEG, problem = 51}),(86,55,BonusDef {position = Point {x = 51, y = 84}, bonus = SUPERFLEX, problem = 55}),(86,94,BonusDef {position = Point {x = 66, y = 81}, bonus = SUPERFLEX, problem = 94}),(87,26,BonusDef {position = Point {x = 207, y = 205}, bonus = GLOBALIST, problem = 26}),(87,100,BonusDef {position = Point {x = 180, y = 189}, bonus = BREAK_A_LEG, problem = 100}),(87,106,BonusDef {position = Point {x = 81, y = 198}, bonus = SUPERFLEX, problem = 106}),(88,27,BonusDef {position = Point {x = 45, y = 87}, bonus = BREAK_A_LEG, problem = 27}),(88,59,BonusDef {position = Point {x = 115, y = 101}, bonus = GLOBALIST, problem = 59}),(88,123,BonusDef {position = Point {x = 90, y = 60}, bonus = BREAK_A_LEG, problem = 123}),(89,18,BonusDef {position = Point {x = 93, y = 84}, bonus = GLOBALIST, problem = 18}),(89,95,BonusDef {position = Point {x = 99, y = 66}, bonus = SUPERFLEX, problem = 95}),(89,103,BonusDef {position = Point {x = 87, y = 111}, bonus = BREAK_A_LEG, problem = 103}),(90,6,BonusDef {position = Point {x = 744, y = 747}, bonus = WALLHACK, problem = 6}),(90,53,BonusDef {position = Point {x = 411, y = 144}, bonus = GLOBALIST, problem = 53}),(90,106,BonusDef {position = Point {x = 69, y = 276}, bonus = SUPERFLEX, problem = 106}),(91,23,BonusDef {position = Point {x = 18, y = 78}, bonus = SUPERFLEX, problem = 23}),(91,54,BonusDef {position = Point {x = 75, y = 81}, bonus = SUPERFLEX, problem = 54}),(91,93,BonusDef {position = Point {x = 27, y = 120}, bonus = GLOBALIST, problem = 93}),(92,7,BonusDef {position = Point {x = 84, y = 72}, bonus = GLOBALIST, problem = 7}),(92,30,BonusDef {position = Point {x = 30, y = 24}, bonus = SUPERFLEX, problem = 30}),(92,99,BonusDef {position = Point {x = 96, y = 12}, bonus = BREAK_A_LEG, problem = 99}),(93,39,BonusDef {position = Point {x = 66, y = 105}, bonus = BREAK_A_LEG, problem = 39}),(93,86,BonusDef {position = Point {x = 27, y = 72}, bonus = GLOBALIST, problem = 86}),(93,90,BonusDef {position = Point {x = 54, y = 108}, bonus = GLOBALIST, problem = 90}),(94,91,BonusDef {position = Point {x = 67, y = 14}, bonus = WALLHACK, problem = 91}),(94,102,BonusDef {position = Point {x = 79, y = 38}, bonus = BREAK_A_LEG, problem = 102}),(94,122,BonusDef {position = Point {x = 55, y = 131}, bonus = SUPERFLEX, problem = 122}),(95,2,BonusDef {position = Point {x = 126, y = 138}, bonus = BREAK_A_LEG, problem = 2}),(95,45,BonusDef {position = Point {x = 135, y = 57}, bonus = SUPERFLEX, problem = 45}),(95,101,BonusDef {position = Point {x = 189, y = 66}, bonus = BREAK_A_LEG, problem = 101}),(96,2,BonusDef {position = Point {x = 141, y = 24}, bonus = WALLHACK, problem = 2}),(96,36,BonusDef {position = Point {x = 93, y = 54}, bonus = SUPERFLEX, problem = 36}),(96,95,BonusDef {position = Point {x = 150, y = 138}, bonus = BREAK_A_LEG, problem = 95}),(97,1,BonusDef {position = Point {x = 198, y = 186}, bonus = WALLHACK, problem = 1}),(97,61,BonusDef {position = Point {x = 288, y = 138}, bonus = WALLHACK, problem = 61}),(97,100,BonusDef {position = Point {x = 282, y = 54}, bonus = GLOBALIST, problem = 100}),(98,34,BonusDef {position = Point {x = 111, y = 33}, bonus = WALLHACK, problem = 34}),(98,93,BonusDef {position = Point {x = 33, y = 225}, bonus = WALLHACK, problem = 93}),(98,97,BonusDef {position = Point {x = 39, y = 99}, bonus = GLOBALIST, problem = 97}),(99,22,BonusDef {position = Point {x = 69, y = 111}, bonus = GLOBALIST, problem = 22}),(99,25,BonusDef {position = Point {x = 66, y = 69}, bonus = GLOBALIST, problem = 25}),(99,91,BonusDef {position = Point {x = 93, y = 51}, bonus = BREAK_A_LEG, problem = 91}),(100,59,BonusDef {position = Point {x = 33, y = 117}, bonus = SUPERFLEX, problem = 59}),(100,85,BonusDef {position = Point {x = 72, y = 126}, bonus = SUPERFLEX, problem = 85}),(100,96,BonusDef {position = Point {x = 192, y = 144}, bonus = WALLHACK, problem = 96}),(101,40,BonusDef {position = Point {x = 76, y = 118}, bonus = WALLHACK, problem = 40}),(101,84,BonusDef {position = Point {x = 97, y = 160}, bonus = BREAK_A_LEG, problem = 84}),(101,98,BonusDef {position = Point {x = 58, y = 160}, bonus = SUPERFLEX, problem = 98}),(102,33,BonusDef {position = Point {x = 51, y = 171}, bonus = WALLHACK, problem = 33}),(102,66,BonusDef {position = Point {x = 243, y = 165}, bonus = WALLHACK, problem = 66}),(102,92,BonusDef {position = Point {x = 81, y = 63}, bonus = GLOBALIST, problem = 92}),(103,3,BonusDef {position = Point {x = 168, y = 36}, bonus = BREAK_A_LEG, problem = 3}),(103,28,BonusDef {position = Point {x = 138, y = 9}, bonus = WALLHACK, problem = 28}),(103,104,BonusDef {position = Point {x = 162, y = 6}, bonus = GLOBALIST, problem = 104}),(104,7,BonusDef {position = Point {x = 15, y = 36}, bonus = SUPERFLEX, problem = 7}),(104,58,BonusDef {position = Point {x = 111, y = 105}, bonus = BREAK_A_LEG, problem = 58}),(104,105,BonusDef {position = Point {x = 102, y = 69}, bonus = SUPERFLEX, problem = 105}),(105,37,BonusDef {position = Point {x = 252, y = 339}, bonus = GLOBALIST, problem = 37}),(105,68,BonusDef {position = Point {x = 471, y = 516}, bonus = SUPERFLEX, problem = 68}),(105,89,BonusDef {position = Point {x = 393, y = 546}, bonus = SUPERFLEX, problem = 89}),(106,51,BonusDef {position = Point {x = 156, y = 69}, bonus = SUPERFLEX, problem = 51}),(106,94,BonusDef {position = Point {x = 270, y = 651}, bonus = BREAK_A_LEG, problem = 94}),(106,104,BonusDef {position = Point {x = 207, y = 252}, bonus = BREAK_A_LEG, problem = 104}),(107,10,BonusDef {position = Point {x = 117, y = 165}, bonus = WALLHACK, problem = 10}),(107,125,BonusDef {position = Point {x = 135, y = 42}, bonus = SUPERFLEX, problem = 125}),(107,130,BonusDef {position = Point {x = 90, y = 165}, bonus = BREAK_A_LEG, problem = 130}),(108,110,BonusDef {position = Point {x = 75, y = 96}, bonus = BREAK_A_LEG, problem = 110}),(108,121,BonusDef {position = Point {x = 93, y = 24}, bonus = WALLHACK, problem = 121}),(108,125,BonusDef {position = Point {x = 45, y = 39}, bonus = GLOBALIST, problem = 125}),(109,43,BonusDef {position = Point {x = 18, y = 75}, bonus = SUPERFLEX, problem = 43}),(109,108,BonusDef {position = Point {x = 72, y = 54}, bonus = BREAK_A_LEG, problem = 108}),(109,115,BonusDef {position = Point {x = 33, y = 57}, bonus = GLOBALIST, problem = 115}),(110,102,BonusDef {position = Point {x = 69, y = 102}, bonus = SUPERFLEX, problem = 102}),(110,128,BonusDef {position = Point {x = 81, y = 66}, bonus = WALLHACK, problem = 128}),(110,131,BonusDef {position = Point {x = 78, y = 45}, bonus = GLOBALIST, problem = 131}),(111,26,BonusDef {position = Point {x = 240, y = 69}, bonus = GLOBALIST, problem = 26}),(111,117,BonusDef {position = Point {x = 36, y = 141}, bonus = BREAK_A_LEG, problem = 117}),(111,126,BonusDef {position = Point {x = 213, y = 150}, bonus = WALLHACK, problem = 126}),(112,77,BonusDef {position = Point {x = 108, y = 156}, bonus = GLOBALIST, problem = 77}),(112,107,BonusDef {position = Point {x = 87, y = 165}, bonus = SUPERFLEX, problem = 107}),(112,108,BonusDef {position = Point {x = 207, y = 51}, bonus = SUPERFLEX, problem = 108}),(113,90,BonusDef {position = Point {x = 75, y = 78}, bonus = SUPERFLEX, problem = 90}),(113,112,BonusDef {position = Point {x = 90, y = 63}, bonus = GLOBALIST, problem = 112}),(113,123,BonusDef {position = Point {x = 33, y = 30}, bonus = SUPERFLEX, problem = 123}),(114,86,BonusDef {position = Point {x = 234, y = 630}, bonus = BREAK_A_LEG, problem = 86}),(114,116,BonusDef {position = Point {x = 207, y = 582}, bonus = WALLHACK, problem = 116}),(114,128,BonusDef {position = Point {x = 159, y = 603}, bonus = GLOBALIST, problem = 128}),(115,19,BonusDef {position = Point {x = 84, y = 156}, bonus = GLOBALIST, problem = 19}),(115,122,BonusDef {position = Point {x = 48, y = 30}, bonus = BREAK_A_LEG, problem = 122}),(115,131,BonusDef {position = Point {x = 18, y = 177}, bonus = SUPERFLEX, problem = 131}),(116,89,BonusDef {position = Point {x = 96, y = 117}, bonus = BREAK_A_LEG, problem = 89}),(116,117,BonusDef {position = Point {x = 129, y = 69}, bonus = SUPERFLEX, problem = 117}),(116,120,BonusDef {position = Point {x = 108, y = 156}, bonus = GLOBALIST, problem = 120}),(117,57,BonusDef {position = Point {x = 144, y = 57}, bonus = GLOBALIST, problem = 57}),(117,111,BonusDef {position = Point {x = 138, y = 147}, bonus = WALLHACK, problem = 111}),(117,118,BonusDef {position = Point {x = 102, y = 30}, bonus = WALLHACK, problem = 118}),(118,97,BonusDef {position = Point {x = 243, y = 279}, bonus = GLOBALIST, problem = 97}),(118,116,BonusDef {position = Point {x = 180, y = 0}, bonus = GLOBALIST, problem = 116}),(118,132,BonusDef {position = Point {x = 189, y = 42}, bonus = BREAK_A_LEG, problem = 132}),(119,42,BonusDef {position = Point {x = 81, y = 69}, bonus = GLOBALIST, problem = 42}),(119,111,BonusDef {position = Point {x = 60, y = 21}, bonus = BREAK_A_LEG, problem = 111}),(119,118,BonusDef {position = Point {x = 24, y = 78}, bonus = WALLHACK, problem = 118}),(120,63,BonusDef {position = Point {x = 69, y = 81}, bonus = WALLHACK, problem = 63}),(120,121,BonusDef {position = Point {x = 27, y = 90}, bonus = SUPERFLEX, problem = 121}),(120,132,BonusDef {position = Point {x = 72, y = 66}, bonus = SUPERFLEX, problem = 132}),(121,21,BonusDef {position = Point {x = 211, y = 231}, bonus = GLOBALIST, problem = 21}),(121,109,BonusDef {position = Point {x = 214, y = 159}, bonus = GLOBALIST, problem = 109}),(121,127,BonusDef {position = Point {x = 40, y = 36}, bonus = SUPERFLEX, problem = 127}),(122,9,BonusDef {position = Point {x = 27, y = 348}, bonus = WALLHACK, problem = 9}),(122,114,BonusDef {position = Point {x = 45, y = 36}, bonus = BREAK_A_LEG, problem = 114}),(122,115,BonusDef {position = Point {x = 129, y = 390}, bonus = GLOBALIST, problem = 115}),(123,24,BonusDef {position = Point {x = 39, y = 78}, bonus = GLOBALIST, problem = 24}),(123,113,BonusDef {position = Point {x = 90, y = 15}, bonus = SUPERFLEX, problem = 113}),(123,114,BonusDef {position = Point {x = 24, y = 105}, bonus = BREAK_A_LEG, problem = 114}),(124,56,BonusDef {position = Point {x = 156, y = 240}, bonus = WALLHACK, problem = 56}),(124,107,BonusDef {position = Point {x = 42, y = 105}, bonus = GLOBALIST, problem = 107}),(124,120,BonusDef {position = Point {x = 117, y = 219}, bonus = BREAK_A_LEG, problem = 120}),(125,52,BonusDef {position = Point {x = 270, y = 84}, bonus = WALLHACK, problem = 52}),(125,126,BonusDef {position = Point {x = 75, y = 270}, bonus = GLOBALIST, problem = 126}),(125,130,BonusDef {position = Point {x = 33, y = 225}, bonus = GLOBALIST, problem = 130}),(126,61,BonusDef {position = Point {x = 57, y = 186}, bonus = BREAK_A_LEG, problem = 61}),(126,122,BonusDef {position = Point {x = 33, y = 339}, bonus = WALLHACK, problem = 122}),(126,129,BonusDef {position = Point {x = 102, y = 312}, bonus = SUPERFLEX, problem = 129}),(127,44,BonusDef {position = Point {x = 39, y = 60}, bonus = GLOBALIST, problem = 44}),(127,112,BonusDef {position = Point {x = 63, y = 12}, bonus = BREAK_A_LEG, problem = 112}),(127,113,BonusDef {position = Point {x = 30, y = 72}, bonus = SUPERFLEX, problem = 113}),(128,25,BonusDef {position = Point {x = 216, y = 123}, bonus = BREAK_A_LEG, problem = 25}),(128,119,BonusDef {position = Point {x = 153, y = 6}, bonus = GLOBALIST, problem = 119}),(128,124,BonusDef {position = Point {x = 39, y = 225}, bonus = BREAK_A_LEG, problem = 124}),(129,98,BonusDef {position = Point {x = 27, y = 165}, bonus = WALLHACK, problem = 98}),(129,110,BonusDef {position = Point {x = 117, y = 24}, bonus = SUPERFLEX, problem = 110}),(129,125,BonusDef {position = Point {x = 156, y = 171}, bonus = BREAK_A_LEG, problem = 125}),(130,70,BonusDef {position = Point {x = 63, y = 78}, bonus = BREAK_A_LEG, problem = 70}),(130,119,BonusDef {position = Point {x = 78, y = 30}, bonus = BREAK_A_LEG, problem = 119}),(130,127,BonusDef {position = Point {x = 75, y = 15}, bonus = GLOBALIST, problem = 127}),(131,23,BonusDef {position = Point {x = 195, y = 84}, bonus = BREAK_A_LEG, problem = 23}),(131,109,BonusDef {position = Point {x = 186, y = 135}, bonus = SUPERFLEX, problem = 109}),(131,124,BonusDef {position = Point {x = 171, y = 36}, bonus = SUPERFLEX, problem = 124}),(132,96,BonusDef {position = Point {x = 38, y = 31}, bonus = WALLHACK, problem = 96}),(132,123,BonusDef {position = Point {x = 17, y = 163}, bonus = SUPERFLEX, problem = 123}),(132,129,BonusDef {position = Point {x = 152, y = 163}, bonus = WALLHACK, problem = 129})]
>>> simple = G.emap (const ()) <$> bonusdepg
>>> G.labEdges <$> simple
[(1,35,()),(1,38,()),(1,50,()),(2,39,()),(2,81,()),(2,87,()),(3,59,()),(3,60,()),(3,81,()),(4,17,()),(4,63,()),(4,92,()),(5,10,()),(5,78,()),(5,110,()),(6,16,()),(6,26,()),(6,50,()),(7,12,()),(7,95,()),(7,115,()),(8,6,()),(8,79,()),(8,105,()),(9,14,()),(9,60,()),(9,64,()),(10,62,()),(10,76,()),(10,85,()),(11,20,()),(11,31,()),(11,49,()),(12,30,()),(12,67,()),(12,69,()),(13,20,()),(13,46,()),(13,88,()),(14,53,()),(14,57,()),(14,118,()),(15,41,()),(15,78,()),(15,94,()),(16,8,()),(16,32,()),(16,74,()),(17,67,()),(17,68,()),(17,84,()),(18,65,()),(18,72,()),(18,129,()),(19,32,()),(19,33,()),(19,71,()),(20,6,()),(20,49,()),(20,97,()),(21,17,()),(21,73,()),(21,111,()),(22,64,()),(22,67,()),(22,74,()),(23,18,()),(23,37,()),(23,124,()),(24,73,()),(24,80,()),(24,128,()),(25,16,()),(25,30,()),(25,82,()),(26,19,()),(26,77,()),(26,78,()),(27,23,()),(27,47,()),(27,107,()),(28,36,()),(28,65,()),(28,80,()),(29,9,()),(29,58,()),(29,114,()),(30,10,()),(30,34,()),(30,105,()),(31,8,()),(31,75,()),(31,130,()),(32,5,()),(32,29,()),(32,72,()),(33,53,()),(33,71,()),(33,131,()),(34,4,()),(34,12,()),(34,13,()),(35,14,()),(35,47,()),(35,126,()),(36,75,()),(36,82,()),(36,96,()),(37,1,()),(37,15,()),(37,119,()),(38,76,()),(38,84,()),(38,101,()),(39,29,()),(39,37,()),(39,100,()),(40,17,()),(40,45,()),(40,109,()),(41,54,()),(41,82,()),(41,92,()),(42,48,()),(42,79,()),(42,127,()),(43,40,()),(43,66,()),(43,88,()),(44,5,()),(44,73,()),(44,88,()),(45,25,()),(45,48,()),(45,52,()),(46,16,()),(46,28,()),(46,31,()),(47,27,()),(47,43,()),(47,58,()),(48,11,()),(48,13,()),(48,76,()),(49,36,()),(49,66,()),(49,104,()),(50,9,()),(50,70,()),(50,91,()),(51,21,()),(51,71,()),(51,72,()),(52,29,()),(52,55,()),(52,113,()),(53,38,()),(53,44,()),(53,116,()),(54,12,()),(54,24,()),(54,65,()),(55,7,()),(55,19,()),(55,47,()),(56,11,()),(56,50,()),(56,90,()),(57,4,()),(57,14,()),(57,33,()),(58,15,()),(58,68,()),(58,106,()),(59,3,()),(59,55,()),(59,60,()),(60,41,()),(60,79,()),(60,80,()),(61,20,()),(61,98,()),(61,132,()),(62,22,()),(62,22,()),(62,74,()),(63,18,()),(63,21,()),(63,38,()),(64,4,()),(64,83,()),(64,85,()),(65,42,()),(65,49,()),(65,62,()),(66,31,()),(66,34,()),(66,103,()),(67,5,()),(67,42,()),(67,45,()),(68,69,()),(68,99,()),(68,102,()),(69,3,()),(69,28,()),(69,70,()),(70,54,()),(70,61,()),(70,103,()),(71,87,()),(71,89,()),(71,120,()),(72,32,()),(72,40,()),(72,117,()),(73,11,()),(73,41,()),(73,86,()),(74,56,()),(74,77,()),(74,121,()),(75,35,()),(75,51,()),(75,81,()),(76,15,()),(76,46,()),(76,64,()),(77,8,()),(77,39,()),(77,83,()),(78,24,()),(78,35,()),(78,56,()),(79,1,()),(79,62,()),(79,83,()),(80,13,()),(80,93,()),(80,112,()),(81,27,()),(81,43,()),(81,69,()),(82,2,()),(82,75,()),(82,108,()),(83,44,()),(83,63,()),(83,101,()),(84,46,()),(84,52,()),(84,99,()),(85,48,()),(85,57,()),(85,87,()),(86,51,()),(86,55,()),(86,94,()),(87,26,()),(87,100,()),(87,106,()),(88,27,()),(88,59,()),(88,123,()),(89,18,()),(89,95,()),(89,103,()),(90,6,()),(90,53,()),(90,106,()),(91,23,()),(91,54,()),(91,93,()),(92,7,()),(92,30,()),(92,99,()),(93,39,()),(93,86,()),(93,90,()),(94,91,()),(94,102,()),(94,122,()),(95,2,()),(95,45,()),(95,101,()),(96,2,()),(96,36,()),(96,95,()),(97,1,()),(97,61,()),(97,100,()),(98,34,()),(98,93,()),(98,97,()),(99,22,()),(99,25,()),(99,91,()),(100,59,()),(100,85,()),(100,96,()),(101,40,()),(101,84,()),(101,98,()),(102,33,()),(102,66,()),(102,92,()),(103,3,()),(103,28,()),(103,104,()),(104,7,()),(104,58,()),(104,105,()),(105,37,()),(105,68,()),(105,89,()),(106,51,()),(106,94,()),(106,104,()),(107,10,()),(107,125,()),(107,130,()),(108,110,()),(108,121,()),(108,125,()),(109,43,()),(109,108,()),(109,115,()),(110,102,()),(110,128,()),(110,131,()),(111,26,()),(111,117,()),(111,126,()),(112,77,()),(112,107,()),(112,108,()),(113,90,()),(113,112,()),(113,123,()),(114,86,()),(114,116,()),(114,128,()),(115,19,()),(115,122,()),(115,131,()),(116,89,()),(116,117,()),(116,120,()),(117,57,()),(117,111,()),(117,118,()),(118,97,()),(118,116,()),(118,132,()),(119,42,()),(119,111,()),(119,118,()),(120,63,()),(120,121,()),(120,132,()),(121,21,()),(121,109,()),(121,127,()),(122,9,()),(122,114,()),(122,115,()),(123,24,()),(123,113,()),(123,114,()),(124,56,()),(124,107,()),(124,120,()),(125,52,()),(125,126,()),(125,130,()),(126,61,()),(126,122,()),(126,129,()),(127,44,()),(127,112,()),(127,113,()),(128,25,()),(128,119,()),(128,124,()),(129,98,()),(129,110,()),(129,125,()),(130,70,()),(130,119,()),(130,127,()),(131,23,()),(131,109,()),(131,124,()),(132,96,()),(132,123,()),(132,129,())]
>>> G.scc <$> simple
[[1,37,23,27,47,35,75,31,11,48,42,65,18,63,4,34,30,12,7,55,52,45,40,43,81,2,82,25,99,68,17,21,51,86,73,24,54,41,15,58,29,32,16,6,8,77,26,87,71,19,115,109,121,74,22,62,10,5,44,53,14,9,50,56,78,124,128,110,108,112,80,28,46,13,76,38,84,101,83,64,79,60,3,59,88,100,39,93,91,94,106,90,113,123,132,61,70,69,130,107,125,129,126,111,117,72,116,114,122,118,119,97,20,98,120,127,103,66,49,102,89,105,104,95,96,36,131,33,57,85,67,92]]
-}
getBonusDeps :: FilePath -> Int -> IO (G.Gr () P.BonusDef)
getBonusDeps path n = loop path n 1 ig
  where
    ig = G.mkGraph (zip [1 .. n] (repeat ())) []

loop :: FilePath -> Int -> Int -> G.Gr () P.BonusDef -> IO (G.Gr () P.BonusDef)
loop path no count g = if
  | no < count -> return g
  | otherwise  -> do
      { mprob <- getProblem path count
      ; loop path no (succ count) (G.insEdges (bonusEdges count mprob) g)
      }

getProblem :: FilePath -> Int -> IO (Maybe P.Problem)
getProblem path n = readProblem (path </> name)
  where
    name = printf "%03d.json" n

bonusEdges :: G.Node -> Maybe P.Problem -> [G.LEdge P.BonusDef]
bonusEdges n0 = \ case
  Nothing -> []
  Just pb -> case P.bonuses pb of
    Nothing -> []
    Just bs -> map (bonusDef2Edge n0) bs
  where
    bonusDef2Edge n def = (n, P.problem def, def)

scc :: G.Gr () () -> [[G.Node]]
scc = G.scc